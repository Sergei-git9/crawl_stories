<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRAWL.STORIES</title>
  <style>
    :root{--bg:#020205;--card:#0b0b0f;--text:#fff;--muted:#9aa0a6;--accent:#FFE81F;--border:rgba(255,255,255,0.1)}
    *{margin:0;padding:0;box-sizing:border-box}
    body{background:var(--bg);color:var(--text);font-family:'Courier New',monospace;min-height:100vh;display:flex;flex-direction:column}
    header{position:sticky;top:0;z-index:100;background:rgba(2,2,5,.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
    main{flex:1;padding:2rem 1.5rem;max-width:1200px;margin:0 auto;width:100%}
    #grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem;margin-top:2rem}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;cursor:pointer;transition:.3s}
    .card:hover{transform:translateY(-8px);box-shadow:0 10px 30px rgba(255,232,31,.3);border-color:var(--accent)}
    .cover{width:100%;height:200px;background:#111;display:flex;align-items:center;justify-content:center;color:#555;font-size:40px;font-weight:bold}
    .info{padding:1rem}
    .title{font-size:18px;font-weight:bold;margin-bottom:8px}
    .desc{font-size:14px;color:var(--muted);margin-bottom:12px}
    .status{display:inline-block;padding:4px 10px;background:rgba(255,232,31,.2);color:var(--accent);border:1px solid var(--accent);border-radius:6px;font-size:12px;font-weight:bold}
    footer{background:rgba(2,2,5,.95);padding:2rem;text-align:center;color:var(--muted);border-top:1px solid var(--border)}
  </style>
</head>
<body>

<header></header>

<main>
  <h1 style="text-align:center;margin-bottom:2rem;color:#FFE81F">CRAWL.STORIES</h1>
  <div id="grid">Загрузка...</div>
</main>

<footer>
  <div>© 2025 CRAWL.STORIES</div>
</footer>

<script src="auth.js"></script>
<script src="themes-system.js"></script>

<script>
// Ждём Firebase
setTimeout(() => {
  if (!window.db) { document.getElementById('grid').innerHTML = 'Ошибка загрузки'; return; }

  db.collection("stories").get().then(snap => {
    const stories = snap.docs.map(d => ({id: d.id, ...d.data()}))
      .filter(s => s.status !== "draft");

    document.getElementById('grid').innerHTML = stories.map(s => `
      <a href="story-info.html?id=${s.id}" class="card">
        <div class="cover">CS</div>
        <div class="info">
          <div class="title">${s.title || "Без названия"}</div>
          <div class="desc">${s.description || ""}</div>
          <div class="status">${s.status === "announcement" ? "Анонс" : s.status === "new" ? "Новинка" : "Выходит"}</div>
        </div>
      </a>
    `).join("") || "Нет историй";
  });
}, 2000);
</script>
</body>
</html>
