<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å CRAWL.STORIES</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>

  <style>
    :root {
      --bg-primary: #020205;
      --bg-secondary: #0b0b0f;
      --bg-card: #0b0b0f;
      --accent-primary: #ffe81f;
      --accent-secondary: #6366f1;
      --text-primary: #ffffff;
      --text-secondary: #9aa0a6;
      --text-muted: #7f8c8d;
      --border-light: rgba(255, 255, 255, 0.1);
      --font-mono: "Courier New", monospace;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: var(--font-mono);
      min-height: 100vh;
    }

    /* LOGIN SCREEN */
    .login-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .login-card {
      max-width: 400px;
      width: 100%;
      text-align: center;
    }

    .login-card h2 {
      color: var(--accent-primary);
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-secondary);
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      background: #05050a;
      color: #ddd;
      font-family: var(--font-mono);
      font-size: 14px;
    }

    /* BUTTONS */
    button {
      background: var(--accent-primary);
      color: var(--bg-primary);
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-family: var(--font-mono);
      font-weight: bold;
      transition: opacity 0.3s;
    }

    button:hover {
      opacity: 0.9;
    }

    .btn-small {
      padding: 8px 16px;
      font-size: 12px;
    }

    .btn-secondary {
      background: transparent;
      color: var(--accent-primary);
      border: 1px solid var(--border-light);
    }

    .btn-danger {
      background: #ff4444;
      color: white;
    }

    .btn-success {
      background: #4caf50;
      color: white;
    }

    .btn-info {
      background: var(--accent-secondary);
      color: white;
    }

    /* ADMIN INTERFACE */
    .admin-interface {
      display: none;
      min-height: 100vh;
    }

    header {
      padding: 15px 20px;
      border-bottom: 1px solid var(--border-light);
      background: rgba(2, 2, 5, 0.95);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
    }

    .header-nav {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* THEME BANNER */
    .theme-banner {
      background: linear-gradient(135deg, var(--theme-accent, var(--accent-primary)), transparent);
      padding: 10px 20px;
      text-align: center;
      font-weight: bold;
      border-bottom: 1px solid var(--border-light);
      animation: slideDown 0.5s ease-out;
    }

    @keyframes slideDown {
      from { transform: translateY(-100%); }
      to { transform: translateY(0); }
    }

    /* MAIN CONTENT */
    .main-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* STORIES GRID */
    .stories-grid {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      margin-top: 20px;
    }

    .story-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid var(--border-light);
      transition: border-color 0.3s;
      cursor: pointer;
      position: relative;
    }

    .story-card:hover {
      border-color: rgba(255, 232, 31, 0.3);
      transform: translateY(-2px);
    }

    .story-card-corner {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 16px;
    }

    .story-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
      gap: 10px;
    }

    .story-title {
      color: var(--accent-primary);
      font-size: 18px;
      margin: 0;
      line-height: 1.3;
      flex: 1;
    }

    .story-meta {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      white-space: nowrap;
      font-weight: bold;
    }

    .badge.announcement {
      background: rgba(255, 193, 7, 0.1);
      color: #ffc107;
    }

    .badge.draft {
      background: rgba(158, 158, 158, 0.1);
      color: #9e9e9e;
    }

    .badge.releasing {
      background: rgba(33, 150, 243, 0.1);
      color: #2196f3;
    }

    .badge.published {
      background: rgba(76, 175, 80, 0.1);
      color: #4caf50;
    }

    .badge.hidden {
      background: rgba(158, 158, 158, 0.1);
      color: #9e9e9e;
      border: 1px dashed #9e9e9e;
    }

    .story-desc {
      color: var(--text-secondary);
      margin-bottom: 15px;
      font-size: 14px;
      line-height: 1.4;
    }

    .story-date {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 8px;
    }

    /* MODALS */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      border: 1px solid var(--border-light);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      color: var(--accent-primary);
      font-size: 20px;
    }

    .close-modal {
      background: none;
      border: none;
      color: var(--text-secondary);
      font-size: 24px;
      cursor: pointer;
      padding: 0;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
    }

    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border-light);
      background: #05050a;
      color: #ddd;
      font-family: var(--font-mono);
      font-size: 14px;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .checkbox-group input[type="checkbox"] {
      width: 16px;
      height: 16px;
    }

    .checkbox-group label {
      margin: 0;
      color: var(--text-secondary);
      font-size: 14px;
    }

    .genres-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .drop-zone {
      border: 2px dashed var(--accent-primary);
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      color: var(--text-secondary);
      margin: 10px 0;
      transition: all 0.3s;
      cursor: pointer;
    }

    .drop-zone:hover {
      background: rgba(255, 232, 31, 0.1);
    }

    .drop-zone.active {
      background: rgba(255, 232, 31, 0.1);
      border-color: var(--accent-primary);
    }

    .date-precision {
      font-size: 12px;
      color: var(--accent-primary);
      margin-top: 5px;
    }

    /* SCHEDULE */
    .schedule-list {
      margin-top: 20px;
    }

    .schedule-item {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid var(--border-light);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .schedule-info {
      flex: 1;
    }

    .schedule-date {
      text-align: right;
      min-width: 200px;
    }

    .publish-date {
      color: var(--accent-primary);
      font-weight: bold;
    }

    .publish-status {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* SETTINGS */
    .settings-grid {
      display: grid;
      gap: 20px;
      margin-top: 20px;
    }

    .settings-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid var(--border-light);
    }

    .theme-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .theme-control {
      background: var(--bg-secondary);
      padding: 15px;
      border-radius: 8px;
      border: 2px solid transparent;
      transition: all 0.3s;
    }

    .theme-control.active {
      border-color: var(--accent-primary);
    }

    .theme-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .theme-name {
      font-weight: bold;
      color: var(--accent-primary);
    }

    .theme-dates {
      font-size: 12px;
      color: var(--text-muted);
    }

    .theme-controls-row {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .intensity-slider {
      width: 100%;
      margin: 10px 0;
    }

    .theme-settings {
      margin-top: 10px;
      padding: 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 6px;
      display: none;
    }

    .theme-settings.active {
      display: block;
    }

    /* EFFECTS CONTAINER */
    #theme-effects {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
    }

    .snowflake, .leaf, .petal, .particle, .bat {
      position: absolute;
      pointer-events: none;
      user-select: none;
    }

    /* EMPTY STATES */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-secondary);
    }

    .empty-state .icon {
      font-size: 48px;
      margin-bottom: 20px;
    }

    /* LOADING */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-secondary);
    }

    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 15px;
      }

      .header-nav {
        justify-content: center;
      }

      .stories-grid {
        grid-template-columns: 1fr;
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .schedule-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }

      .schedule-date {
        text-align: left;
        width: 100%;
      }

      .theme-controls {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- THEME EFFECTS CONTAINER -->
  <div id="theme-effects"></div>

  <!-- THEME BANNER -->
  <div id="themeBanner" class="theme-banner" style="display: none;"></div>

  <!-- LOGIN SCREEN -->
  <div id="loginScreen" class="login-screen">
    <div class="login-card">
      <h2>üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
      <form id="loginForm">
        <div class="form-group">
          <label>–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</label>
          <input type="password" id="adminPassword" required />
        </div>
        <button type="submit">–í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É</button>
      </form>
    </div>
  </div>

  <!-- ADMIN INTERFACE -->
  <div id="adminInterface" class="admin-interface">
    <header>
      <div class="header-content">
        <h1 id="siteLogo">‚öôÔ∏è –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ CRAWL.STORIES</h1>
        <div class="header-nav">
          <button id="btnCreateStory" class="btn btn-success">‚ûï –°–æ–∑–¥–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
          <button id="btnStories" class="btn btn-secondary">üìö –ò—Å—Ç–æ—Ä–∏–∏</button>
          <button id="btnSchedule" class="btn btn-secondary">üìÖ –ì—Ä–∞—Ñ–∏–∫</button>
          <button id="btnImport" class="btn btn-info">üì• –ò–º–ø–æ—Ä—Ç –≥–æ—Ç–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏</button>
          <button id="btnSettings" class="btn btn-secondary">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
          <button id="btnLogout" class="btn btn-danger">üö™ –í—ã–π—Ç–∏</button>
        </div>
      </div>
    </header>

    <div class="main-content">
      <!-- STORIES VIEW -->
      <div id="storiesView">
        <h2>üìö –í—Å–µ –∏—Å—Ç–æ—Ä–∏–∏</h2>
        <div id="storiesList" class="stories-grid">
          <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–π...</div>
        </div>
      </div>

     <div id="scheduleView" style="display: none;">
  <h2>üìÖ –ì—Ä–∞—Ñ–∏–∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–π</h2>
  
  <!-- –í–ö–õ–ê–î–ö–ò -->
  <div class="tabs-container" style="display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap;">
    <button class="tab active" data-tab="episodes" style="padding: 10px 20px; background: var(--accent-primary); color: var(--bg-primary); border: none; border-radius: 8px; cursor: pointer;">
      üìñ –≠–ø–∏–∑–æ–¥—ã
    </button>
    <button class="tab" data-tab="stories" style="padding: 10px 20px; background: transparent; color: var(--text-secondary); border: 1px solid var(--border-light); border-radius: 8px; cursor: pointer;">
      üìÖ –ò—Å—Ç–æ—Ä–∏–∏
    </button>
  </div>
  
  <!-- –≠–ü–ò–ó–û–î–´ -->
  <div id="episodesSchedule" class="schedule-list">
    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —ç–ø–∏–∑–æ–¥–æ–≤...</div>
  </div>
  
  <!-- –ò–°–¢–û–†–ò–ò -->
  <div id="storiesSchedule" class="schedule-list" style="display: none;">
    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–π...</div>
  </div>
</div>
      <!-- IMPORT VIEW -->
      <div id="importView" style="display: none;">
        <h2>üì• –ò–º–ø–æ—Ä—Ç –≥–æ—Ç–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏</h2>
        <div class="empty-state">
          <div class="icon">üì•</div>
          <p>–§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏</p>
        </div>
      </div>

      <!-- SETTINGS VIEW -->
      <div id="settingsView" style="display: none;">
        <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞</h2>
        <div class="settings-grid">
          <div class="settings-card">
            <h3>üé® –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏</h3>
            <div style="margin-bottom: 20px;">
              <div class="checkbox-group">
                <input type="checkbox" id="autoThemeMode" checked>
                <label for="autoThemeMode">üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º –ø–æ –¥–∞—Ç–∞–º</label>
              </div>
            </div>
            
            <div class="theme-controls" id="themeControls">
              <!-- Themes will be loaded here -->
            </div>
            
            <div style="margin-top: 20px;">
              <button class="btn btn-success" onclick="adminPanel.createCustomTheme()">
                üé® –°–æ–∑–¥–∞—Ç—å —Å–≤–æ—é —Ç–µ–º—É
              </button>
              <button class="btn btn-secondary" onclick="adminPanel.resetThemes()" style="margin-left: 10px;">
                üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ç–µ–º—ã
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: CREATE STORY -->
  <div id="createStoryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">‚ûï –°–æ–∑–¥–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é</h3>
        <button class="close-modal">&times;</button>
      </div>
      
      <form id="createStoryForm">
        <div class="form-group">
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ *</label>
          <input type="text" id="storyTitle" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏">
        </div>

        <div class="form-group">
          <label>–û–±–ª–æ–∂–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏</label>
          <div class="drop-zone" id="coverDropZone">
            <div>üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</div>
            <div style="font-size: 12px; margin-top: 8px;">–∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>
            <input type="file" id="coverFile" accept="image/*" style="display: none;">
          </div>
          <div id="coverPreview" style="display: none; margin-top: 10px;">
            <img id="coverPreviewImg" style="max-width: 200px; border-radius: 8px;">
          </div>
        </div>

        <div class="form-group">
          <label>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
          <textarea id="storyDescription" rows="3" placeholder="–û–ø–∏—à–∏—Ç–µ —Å—é–∂–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏..."></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–∏–∑–æ–¥–æ–≤</label>
            <input type="number" id="plannedEpisodes" min="0" placeholder="–ù–µ —É–∫–∞–∑–∞–Ω–æ">
          </div>
          <div class="form-group">
            <label>–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</label>
            <input type="text" id="publishDate" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì, –ú–ú.–ì–ì–ì–ì –∏–ª–∏ –ì–ì–ì–ì">
            <div class="date-precision" id="datePrecision"></div>
          </div>
        </div>

        <div class="form-group">
          <label>–ñ–∞–Ω—Ä—ã</label>
          <div class="genres-container">
            <div class="checkbox-group">
              <input type="checkbox" id="genreFantasy" value="fantasy">
              <label for="genreFantasy">üßô –§—ç–Ω—Ç–µ–∑–∏</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="genreScifi" value="sci-fi">
              <label for="genreScifi">üöÄ –ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="genreHorror" value="horror">
              <label for="genreHorror">üëª –•–æ—Ä—Ä–æ—Ä</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="genreAdventure" value="adventure">
              <label for="genreAdventure">üó∫Ô∏è –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="genreMystery" value="mystery">
              <label for="genreMystery">üïµÔ∏è –ú–∏—Å—Ç–∏–∫–∞</label>
            </div>
            <div class="checkbox-group">
              <input type="checkbox" id="genreRomance" value="romance">
              <label for="genreRomance">üíñ –†–æ–º–∞–Ω—Ç–∏–∫–∞</label>
            </div>
          </div>
        </div>

        <div class="form-actions" style="display: flex; gap: 10px; margin-top: 20px;">
          <button type="button" class="btn btn-secondary" id="btnCancelStory">‚ùå –û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn btn-success">‚úÖ –°–æ–∑–¥–∞—Ç—å –∞–Ω–æ–Ω—Å</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    class ThemeSystem {
      constructor() {
        this.themes = {
          new_year: {
            id: "new_year",
            name: "–ù–æ–≤—ã–π –≥–æ–¥",
            auto: true,
            startDate: "20.12",
            endDate: "10.01",
            effects: { snow: true, particlesSpeed: "normal" },
            decorations: { logoEmoji: "üéÑ", cardCorner: "‚ùÑÔ∏è", specialBanner: "üéÑ –° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üéÑ" },
            colors: { accent: "#4fffdc", backgroundOverlay: "rgba(0,0,0,0.15)" }
          },
          christmas: {
            id: "christmas",
            name: "–†–æ–∂–¥–µ—Å—Ç–≤–æ",
            auto: true,
            startDate: "05.01",
            endDate: "08.01",
            effects: { snow: true, particlesSpeed: "slow" },
            decorations: { logoEmoji: "‚≠ê", cardCorner: "üåü", specialBanner: "‚≠ê –° –†–æ–∂–¥–µ—Å—Ç–≤–æ–º! ‚≠ê" },
            colors: { accent: "#ffd700", backgroundOverlay: "rgba(255,215,0,0.1)" }
          },
          halloween: {
            id: "halloween",
            name: "–•–µ–ª–ª–æ—É–∏–Ω",
            auto: true,
            startDate: "27.10",
            endDate: "02.11",
            effects: { bats: true, fog: true },
            decorations: { logoEmoji: "üéÉ", cardCorner: "üëª", specialBanner: "üéÉ –°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –•–µ–ª–ª–æ—É–∏–Ω–∞! üéÉ" },
            colors: { accent: "#ff8c00", backgroundOverlay: "rgba(128,0,128,0.1)" }
          },
          spring: {
            id: "spring",
            name: "–í–µ—Å–Ω–∞",
            auto: true,
            startDate: "01.03",
            endDate: "31.05",
            effects: { petals: true },
            decorations: { logoEmoji: "üå∏", cardCorner: "üå∫", specialBanner: "üå∏ –í–µ—Å–Ω–∞ –ø—Ä–∏—à–ª–∞! üå∏" },
            colors: { accent: "#ff69b4", backgroundOverlay: "rgba(144,238,144,0.1)" }
          },
          summer: {
            id: "summer",
            name: "–õ–µ—Ç–æ",
            auto: true,
            startDate: "01.06",
            endDate: "31.08",
            effects: { particles: true },
            decorations: { logoEmoji: "‚òÄÔ∏è", cardCorner: "üåä", specialBanner: "‚òÄÔ∏è –õ–µ—Ç–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ! ‚òÄÔ∏è" },
            colors: { accent: "#00bfff", backgroundOverlay: "rgba(173,216,230,0.1)" }
          },
          autumn: {
            id: "autumn",
            name: "–û—Å–µ–Ω—å",
            auto: true,
            startDate: "01.09",
            endDate: "30.11",
            effects: { leaves: true },
            decorations: { logoEmoji: "üçÅ", cardCorner: "üçÇ", specialBanner: "üçÅ –û—Å–µ–Ω–Ω—è—è –ø–æ—Ä–∞! üçÅ" },
            colors: { accent: "#ff8c00", backgroundOverlay: "rgba(210,180,140,0.1)" }
          },
          winter: {
            id: "winter",
            name: "–ó–∏–º–∞",
            auto: true,
            startDate: "01.12",
            endDate: "28.02",
            effects: { snow: true },
            decorations: { logoEmoji: "üßä", cardCorner: "‚õÑ", specialBanner: "üßä –ó–∏–º–Ω—è—è —Å–∫–∞–∑–∫–∞! üßä" },
            colors: { accent: "#87ceeb", backgroundOverlay: "rgba(176,224,230,0.1)" }
          },
          birthday: {
            id: "birthday",
            name: "–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è —Å–∞–π—Ç–∞",
            auto: false,
            effects: { confetti: true },
            decorations: { logoEmoji: "üéâ", cardCorner: "üéÇ", specialBanner: "üéâ –° –î–Ω–µ–º –†–æ–∂–¥–µ–Ω–∏—è! üéâ" },
            colors: { accent: "#ff69b4", backgroundOverlay: "rgba(255,105,180,0.1)" }
          },
          neon: {
            id: "neon",
            name: "–¢–µ–º–Ω–∞—è –Ω–µ–æ–Ω–æ–≤–∞—è —Ç–µ–º–∞",
            auto: false,
            effects: {},
            decorations: { logoEmoji: "‚ú®", cardCorner: "üí´", specialBanner: "‚ú® –ù–µ–æ–Ω–æ–≤–∞—è —Ç–µ–º–∞! ‚ú®" },
            colors: { accent: "#8a2be2", backgroundOverlay: "rgba(138,43,226,0.1)" }
          },
          anime: {
            id: "anime",
            name: "–ê–Ω–∏–º–µ-—Ç–µ–º–∞",
            auto: false,
            effects: { hearts: true },
            decorations: { logoEmoji: "üíó", cardCorner: "üò∫", specialBanner: "üíó –ê–Ω–∏–º–µ —Ä–µ–∂–∏–º! üíó" },
            colors: { accent: "#ff1493", backgroundOverlay: "rgba(255,20,147,0.1)" }
          }
        };
        
        this.currentTheme = null;
        this.manualTheme = null;
        this.manualThemeExpiry = null;
        this.autoMode = true;
        this.effectsContainer = document.getElementById('theme-effects');
        
        this.loadSettings();
      }

      async loadSettings() {
        try {
          // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
          const saved = localStorage.getItem('themeSettings');
          if (saved) {
            const settings = JSON.parse(saved);
            this.autoMode = settings.autoMode !== false;
            this.manualTheme = settings.manualTheme || null;
            this.manualThemeExpiry = settings.manualThemeExpiry || null;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –∏—Å—Ç–µ–∫–ª–∞ –ª–∏ —Ä—É—á–Ω–∞—è —Ç–µ–º–∞
            if (this.manualThemeExpiry && new Date() > new Date(this.manualThemeExpiry)) {
              this.manualTheme = null;
              this.manualThemeExpiry = null;
              this.saveSettings();
            }
          }
        } catch (e) {
          console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–µ–º:', e);
        }
        
        this.applyCurrentTheme();
      }

      async saveSettings() {
        try {
          const settings = {
            autoMode: this.autoMode,
            manualTheme: this.manualTheme,
            manualThemeExpiry: this.manualThemeExpiry
          };
          localStorage.setItem('themeSettings', JSON.stringify(settings));
          
          // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firestore –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
          if (window.adminPanel?.db) {
            await window.adminPanel.db.collection('settings').doc('theme').set(settings);
          }
        } catch (e) {
          console.warn('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–µ–º:', e);
        }
      }

      getCurrentDate() {
        const now = new Date();
        return {
          day: now.getDate(),
          month: now.getMonth() + 1,
          year: now.getFullYear()
        };
      }

      isDateInRange(theme, currentDate) {
        if (!theme.startDate || !theme.endDate) return false;
        
        const [startDay, startMonth] = theme.startDate.split('.').map(Number);
        const [endDay, endMonth] = theme.endDate.split('.').map(Number);
        
        const current = currentDate.month * 100 + currentDate.day;
        const start = startMonth * 100 + startDay;
        const end = endMonth * 100 + endDay;
        
        if (start <= end) {
          return current >= start && current <= end;
        } else {
          return current >= start || current <= end;
        }
      }

      detectAutoTheme() {
        if (!this.autoMode) return null;
        
        const currentDate = this.getCurrentDate();
        const activeThemes = [];
        
        for (const theme of Object.values(this.themes)) {
          if (theme.auto && this.isDateInRange(theme, currentDate)) {
            activeThemes.push(theme);
          }
        }
        
        // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ > —Å–µ–∑–æ–Ω–Ω—ã–µ > –æ–±—ã—á–Ω—ã–µ
        const holidayThemes = ['new_year', 'christmas', 'halloween', 'birthday'];
        const seasonalThemes = ['spring', 'summer', 'autumn', 'winter'];
        
        const holiday = activeThemes.find(t => holidayThemes.includes(t.id));
        if (holiday) return holiday;
        
        const seasonal = activeThemes.find(t => seasonalThemes.includes(t.id));
        if (seasonal) return seasonal;
        
        return activeThemes[0] || null;
      }

      applyCurrentTheme() {
        let themeToApply = null;
        
        if (this.manualTheme) {
          themeToApply = this.themes[this.manualTheme];
        } else if (this.autoMode) {
          themeToApply = this.detectAutoTheme();
        }
        
        this.applyTheme(themeToApply);
      }

      applyTheme(theme) {
        if (!theme) {
          this.clearTheme();
          return;
        }
        
        this.currentTheme = theme;
        this.updateCSSVariables(theme);
        this.updateDecorations(theme);
        this.showBanner(theme);
        this.createEffects(theme);
        
        console.log(`‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —Ç–µ–º–∞: ${theme.name}`);
      }

      updateCSSVariables(theme) {
        const root = document.documentElement;
        if (theme.colors?.accent) {
          root.style.setProperty('--accent-primary', theme.colors.accent);
        }
      }

      updateDecorations(theme) {
        const logo = document.getElementById('siteLogo');
        if (logo && theme.decorations?.logoEmoji) {
          logo.innerHTML = `${theme.decorations.logoEmoji} –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ CRAWL.STORIES`;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —É–≥–ª—ã –∫–∞—Ä—Ç–æ—á–µ–∫ –∏—Å—Ç–æ—Ä–∏–π
        document.querySelectorAll('.story-card').forEach(card => {
          let corner = card.querySelector('.story-card-corner');
          if (!corner) {
            corner = document.createElement('div');
            corner.className = 'story-card-corner';
            card.appendChild(corner);
          }
          corner.textContent = theme.decorations?.cardCorner || '';
        });
      }

      showBanner(theme) {
        const banner = document.getElementById('themeBanner');
        if (banner && theme.decorations?.specialBanner) {
          banner.textContent = theme.decorations.specialBanner;
          banner.style.display = 'block';
          banner.style.setProperty('--theme-accent', theme.colors?.accent);
        } else if (banner) {
          banner.style.display = 'none';
        }
      }

      createEffects(theme) {
        this.clearEffects();
        
        if (!theme.effects) return;
        
        if (theme.effects.snow) this.createSnowEffect();
        if (theme.effects.leaves) this.createLeavesEffect();
        if (theme.effects.petals) this.createPetalsEffect();
        if (theme.effects.hearts) this.createHeartsEffect();
        if (theme.effects.confetti) this.createConfettiEffect();
        if (theme.effects.bats) this.createBatsEffect();
        if (theme.effects.fog) this.createFogEffect();
      }

      createSnowEffect() {
        for (let i = 0; i < 50; i++) {
          setTimeout(() => {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.textContent = '‚ùÑ';
            snowflake.style.left = Math.random() * 100 + '%';
            snowflake.style.fontSize = (8 + Math.random() * 12) + 'px';
            snowflake.style.opacity = 0.3 + Math.random() * 0.7;
            snowflake.style.animation = `fall ${3 + Math.random() * 5}s linear infinite`;
            this.effectsContainer.appendChild(snowflake);
          }, i * 100);
        }
      }

      createLeavesEffect() {
        for (let i = 0; i < 30; i++) {
          setTimeout(() => {
            const leaf = document.createElement('div');
            leaf.className = 'leaf';
            leaf.textContent = 'üçÅ';
            leaf.style.left = Math.random() * 100 + '%';
            leaf.style.fontSize = (12 + Math.random() * 16) + 'px';
            leaf.style.animation = `fall ${4 + Math.random() * 6}s linear infinite`;
            this.effectsContainer.appendChild(leaf);
          }, i * 150);
        }
      }

      createPetalsEffect() {
        for (let i = 0; i < 25; i++) {
          setTimeout(() => {
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.textContent = 'üå∏';
            petal.style.left = Math.random() * 100 + '%';
            petal.style.fontSize = (10 + Math.random() * 14) + 'px';
            petal.style.animation = `fall ${5 + Math.random() * 5}s linear infinite`;
            this.effectsContainer.appendChild(petal);
          }, i * 200);
        }
      }

      createHeartsEffect() {
        for (let i = 0; i < 20; i++) {
          setTimeout(() => {
            const heart = document.createElement('div');
            heart.className = 'particle';
            heart.textContent = 'üíó';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.fontSize = (8 + Math.random() * 10) + 'px';
            heart.style.animation = `fall ${6 + Math.random() * 4}s linear infinite`;
            this.effectsContainer.appendChild(heart);
          }, i * 250);
        }
      }

      createConfettiEffect() {
        const confettiChars = ['üéâ', 'üéä', '‚ú®', 'üåü'];
        for (let i = 0; i < 40; i++) {
          setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'particle';
            confetti.textContent = confettiChars[Math.floor(Math.random() * confettiChars.length)];
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.fontSize = (10 + Math.random() * 12) + 'px';
            confetti.style.animation = `fall ${2 + Math.random() * 3}s linear infinite`;
            this.effectsContainer.appendChild(confetti);
          }, i * 75);
        }
      }

      createBatsEffect() {
        for (let i = 0; i < 15; i++) {
          setTimeout(() => {
            const bat = document.createElement('div');
            bat.className = 'bat';
            bat.textContent = 'ü¶á';
            bat.style.left = '-50px';
            bat.style.top = (Math.random() * 80 + 10) + '%';
            bat.style.fontSize = (12 + Math.random() * 10) + 'px';
            bat.style.animation = `fly ${8 + Math.random() * 4}s linear infinite`;
            this.effectsContainer.appendChild(bat);
          }, i * 1000);
        }
      }

      createFogEffect() {
        const fog = document.createElement('div');
        fog.style.position = 'fixed';
        fog.style.bottom = '0';
        fog.style.left = '0';
        fog.style.right = '0';
        fog.style.height = '30%';
        fog.style.background = 'linear-gradient(transparent, rgba(128, 128, 128, 0.3))';
        fog.style.pointerEvents = 'none';
        fog.style.zIndex = '9998';
        document.body.appendChild(fog);
      }

      clearEffects() {
        this.effectsContainer.innerHTML = '';
        // –£–¥–∞–ª—è–µ–º —Ç—É–º–∞–Ω –µ—Å–ª–∏ –µ—Å—Ç—å
        const fog = document.querySelector('div[style*="linear-gradient(transparent, rgba(128, 128, 128, 0.3)"]');
        if (fog) fog.remove();
      }

      clearTheme() {
        this.currentTheme = null;
        this.clearEffects();
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const root = document.documentElement;
        root.style.setProperty('--accent-primary', '#ffe81f');
        
        // –£–±–∏—Ä–∞–µ–º –¥–µ–∫–æ—Ä
        const logo = document.getElementById('siteLogo');
        if (logo) logo.innerHTML = '‚öôÔ∏è –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ CRAWL.STORIES';
        
        document.querySelectorAll('.story-card-corner').forEach(corner => {
          corner.remove();
        });
        
        const banner = document.getElementById('themeBanner');
        if (banner) banner.style.display = 'none';
      }

      setManualTheme(themeId, days = null) {
        this.manualTheme = themeId;
        
        if (days) {
          const expiry = new Date();
          expiry.setDate(expiry.getDate() + days);
          this.manualThemeExpiry = expiry.toISOString();
        } else {
          this.manualThemeExpiry = null;
        }
        
        this.saveSettings();
        this.applyCurrentTheme();
      }

      disableManualTheme() {
        this.manualTheme = null;
        this.manualThemeExpiry = null;
        this.saveSettings();
        this.applyCurrentTheme();
      }

      setAutoMode(enabled) {
        this.autoMode = enabled;
        this.saveSettings();
        this.applyCurrentTheme();
      }

      getActiveTheme() {
        if (this.manualTheme) {
          return {
            theme: this.themes[this.manualTheme],
            mode: 'manual',
            expiry: this.manualThemeExpiry
          };
        } else if (this.autoMode) {
          return {
            theme: this.detectAutoTheme(),
            mode: 'auto'
          };
        } else {
          return { theme: null, mode: 'none' };
        }
      }

      init() {
        this.applyCurrentTheme();
        this.addEffectAnimations();
      }

      addEffectAnimations() {
        if (!document.getElementById('theme-animations')) {
          const style = document.createElement('style');
          style.id = 'theme-animations';
          style.textContent = `
            @keyframes fall {
              to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
              }
            }
            @keyframes fly {
              0% {
                transform: translateX(0) translateY(0);
                opacity: 0;
              }
              10% {
                opacity: 1;
              }
              90% {
                opacity: 1;
              }
              100% {
                transform: translateX(100vw) translateY(${Math.random() * 100 - 50}px);
                opacity: 0;
              }
            }
          `;
          document.head.appendChild(style);
        }
      }
    }

    class AdminPanel {
      constructor() {
        this.stories = [];
        this.currentView = 'stories';
        this.adminPassword = "1111";
        this.setupScheduleTabs();
        
        
        this.firebaseConfig = {
          apiKey: "AIzaSyANC4K0-xI-9SvrpoiOp4v-N2XLvCQCALg",
          authDomain: "crawl-stories.firebaseapp.com",
          projectId: "crawl-stories",
          storageBucket: "crawl-stories.firebasestorage.app",
          messagingSenderId: "886479757650",
          appId: "1:886479757650:web:194ad1dd2d02c959bdda8b",
          measurementId: "G-SGC2HF0455",
        };

        this.init();
      }

      async init() {
        try {
          if (typeof firebase !== 'undefined') {
            firebase.initializeApp(this.firebaseConfig);
            this.db = firebase.firestore();
            console.log("üî• Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
          } else {
            console.warn("Firebase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–∏–º –¥–µ–º–æ");
          }

          this.setupEventListeners();
          this.showLoginScreen();
          
        } catch (error) {
          console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
        }
      }

      showLoginScreen() {
        document.getElementById("loginScreen").style.display = "flex";
        document.getElementById("adminInterface").style.display = "none";
      }

      showAdminInterface() {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("adminInterface").style.display = "block";
        this.loadStories();
        
        // –ñ–¥–µ–º –ø–æ–∫–∞ themes-system.js –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
        const waitForThemes = () => {
          if (window.themesSystem) {
            this.loadThemeControls();
          } else {
            setTimeout(waitForThemes, 50);
          }
        };
        waitForThemes();
      }

      setupEventListeners() {
        // –õ–æ–≥–∏–Ω
        document.getElementById("loginForm").addEventListener("submit", (e) => {
          e.preventDefault();
          this.handleLogin();
        });

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        document.getElementById("btnCreateStory").addEventListener("click", () => {
          this.showCreateStoryModal();
        });

        document.getElementById("btnStories").addEventListener("click", () => {
          this.showView('stories');
        });

        document.getElementById("btnSchedule").addEventListener("click", () => {
          this.showView('schedule');
        });

        document.getElementById("btnImport").addEventListener("click", () => {
          this.showView('import');
        });

        document.getElementById("btnSettings").addEventListener("click", () => {
          this.showView('settings');
        });

        document.getElementById("btnLogout").addEventListener("click", () => {
          this.showLoginScreen();
        });

        // –ê–≤—Ç–æ-—Ä–µ–∂–∏–º —Ç–µ–º
        if (document.getElementById('autoThemeMode')) {
          document.getElementById('autoThemeMode').addEventListener('change', (e) => {
            if (e.target.checked) {
              window.themesSystem?.disableManualMode();
            } else {
              // –û—Å—Ç–∞–µ–º—Å—è –≤ —Ä—É—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
            }
            this.loadThemeControls();
          });
        }

        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
        document.getElementById("createStoryForm").addEventListener("submit", (e) => {
          e.preventDefault();
          this.createStory();
        });

        document.getElementById("btnCancelStory").addEventListener("click", () => {
          this.hideModal('createStoryModal');
        });

        document.querySelector("#createStoryModal .close-modal").addEventListener("click", () => {
          this.hideModal('createStoryModal');
        });

        // Drag & drop –¥–ª—è –æ–±–ª–æ–∂–∫–∏
        const dropZone = document.getElementById('coverDropZone');
        const fileInput = document.getElementById('coverFile');

        dropZone.addEventListener('click', () => {
          fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
          this.handleCoverSelect(e.target.files[0]);
        });

        dropZone.addEventListener('dragover', (e) => {
          e.preventDefault();
          dropZone.classList.add('active');
        });

        dropZone.addEventListener('dragleave', () => {
          dropZone.classList.remove('active');
        });

        dropZone.addEventListener('drop', (e) => {
          e.preventDefault();
          dropZone.classList.remove('active');
          const file = e.dataTransfer.files[0];
          if (file && file.type.startsWith('image/')) {
            this.handleCoverSelect(file);
          }
        });

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–∞—Ç—ã
        document.getElementById('publishDate').addEventListener('input', (e) => {
          this.updateDatePrecision(e.target.value);
        });
      }

      handleLogin() {
        const password = document.getElementById("adminPassword").value;
        if (password === this.adminPassword) {
          this.showAdminInterface();
        } else {
          alert("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
        }
      }

      showView(viewName) {
        // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤—å—é
        document.getElementById('storiesView').style.display = 'none';
        document.getElementById('scheduleView').style.display = 'none';
        document.getElementById('importView').style.display = 'none';
        document.getElementById('settingsView').style.display = 'none';

        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤—å—é
        document.getElementById(viewName + 'View').style.display = 'block';
        this.currentView = viewName;

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if (viewName === 'stories') {
          this.loadStories();
        } else if (viewName === 'schedule') {
  this.loadEpisodesSchedule();
  setTimeout(() => {
    this.setupScheduleTabs();
  }, 100);
}
        }
      // ========== –ù–û–í–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –ì–†–ê–§–ò–ö–ê ==========

setupScheduleTabs() {
  const tabs = document.querySelectorAll('#scheduleView .tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
      tabs.forEach(t => {
        t.style.background = 'transparent';
        t.style.color = 'var(--text-secondary)';
        t.style.border = '1px solid var(--border-light)';
      });
      
      // –î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å
      tab.style.background = 'var(--accent-primary)';
      tab.style.color = 'var(--bg-primary)';
      tab.style.border = 'none';
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
      const tabName = tab.dataset.tab;
      document.getElementById('episodesSchedule').style.display = 'none';
      document.getElementById('storiesSchedule').style.display = 'none';
      document.getElementById(tabName + 'Schedule').style.display = 'block';
      
      // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
      if (tabName === 'episodes') {
        this.loadEpisodesSchedule();
      } else {
        this.loadStoriesSchedule();
      }
    });
  });
}

async loadEpisodesSchedule() {
  try {
    const container = document.getElementById('episodesSchedule');
    container.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —ç–ø–∏–∑–æ–¥–æ–≤...</div>';
    
    if (!this.db) {
      container.innerHTML = '<div class="empty-state">Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</div>';
      return;
    }
    
    const episodesSnapshot = await this.db.collection('episodes')
      .where('status', 'in', ['scheduled', 'published'])
      .get();
    
    if (episodesSnapshot.empty) {
      container.innerHTML = '<div class="empty-state">–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–ø–∏–∑–æ–¥–æ–≤</div>';
      return;
    }
    
    const episodesWithStories = await Promise.all(
      episodesSnapshot.docs.map(async (doc) => {
        const episode = { id: doc.id, ...doc.data() };
        try {
          const storyDoc = await this.db.collection('stories').doc(episode.storyId).get();
          episode.storyTitle = storyDoc.exists ? storyDoc.data().title : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è';
        } catch (e) {
          episode.storyTitle = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
        }
        return episode;
      })
    );
    
    container.innerHTML = episodesWithStories.map(episode => {
      const publishDate = episode.publishDate ? 
        (episode.publishDate.toDate ? episode.publishDate.toDate() : new Date(episode.publishDate)) : 
        new Date();
      
      return `
        <div class="schedule-item">
          <div class="schedule-info">
            <h4>${episode.storyTitle} #${episode.episodeNumber} - ${episode.title}</h4>
            <p>${episode.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
          </div>
          <div class="schedule-date">
            <input type="datetime-local" 
                   value="${publishDate.toISOString().slice(0, 16)}"
                   onchange="adminPanel.updateEpisodeDate('${episode.id}', this.value)"
                   style="padding: 8px; border: 1px solid var(--border-light); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);">
            <div class="publish-status">${episode.status === 'published' ? '‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω' : '‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω'}</div>
          </div>
        </div>
      `;
    }).join('');
    
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ø–∏–∑–æ–¥–æ–≤:', error);
    document.getElementById('episodesSchedule').innerHTML = '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ø–∏–∑–æ–¥–æ–≤</div>';
  }
}

async loadStoriesSchedule() {
  try {
    const container = document.getElementById('storiesSchedule');
    
    // –ò—Å—Ç–æ—Ä–∏–∏ –±–µ–∑ —ç–ø–∏–∑–æ–¥–æ–≤ –∏ —Å —Å—Ç–∞—Ç—É—Å–æ–º –∞–Ω–æ–Ω—Å
    const storiesForAnnounce = this.stories.filter(story => 
      (story.episodesCount === 0 || !story.episodesCount) && 
      story.status === 'announcement'
    );
    
    if (storiesForAnnounce.length === 0) {
      container.innerHTML = '<div class="empty-state">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–π –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞–Ω–æ–Ω—Å–æ–≤</div>';
      return;
    }
    
    container.innerHTML = storiesForAnnounce.map(story => {
      let currentDate = '';
      if (story.publishDate) {
        try {
          if (story.publishDate.match(/^\d{2}\.\d{2}\.\d{4}$/)) {
            const [day, month, year] = story.publishDate.split('.');
            currentDate = `${year}-${month}-${day}`;
          }
        } catch (e) {}
      }
      
      return `
        <div class="schedule-item">
          <div class="schedule-info">
            <h4>${story.title}</h4>
            <p>${story.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
          </div>
          <div class="schedule-date">
            <input type="date" 
                   value="${currentDate}"
                   onchange="adminPanel.updateStoryAnnounceDate('${story.id}', this.value)"
                   style="padding: 8px; border: 1px solid var(--border-light); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary);"
                   placeholder="–ó–∞–¥–∞—Ç—å –¥–∞—Ç—É –∞–Ω–æ–Ω—Å–∞">
            <div class="publish-status">${story.publishDate ? 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω' : '‚è≥ –ë–µ–∑ –¥–∞—Ç—ã'}</div>
          </div>
        </div>
      `;
    }).join('');
    
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–π:', error);
    document.getElementById('storiesSchedule').innerHTML = '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–π</div>';
  }
}

async updateEpisodeDate(episodeId, newDate) {
  try {
    await this.db.collection('episodes').doc(episodeId).update({
      publishDate: new Date(newDate),
      updatedAt: new Date()
    });
    alert('‚úÖ –î–∞—Ç–∞ —ç–ø–∏–∑–æ–¥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
    this.loadEpisodesSchedule();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
    alert('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞—Ç—ã —ç–ø–∏–∑–æ–¥–∞');
  }
}

async updateStoryAnnounceDate(storyId, newDate) {
  try {
    const date = new Date(newDate);
    const formattedDate = `${date.getDate().toString().padStart(2, '0')}.${(date.getMonth() + 1).toString().padStart(2, '0')}.${date.getFullYear()}`;
    
    await this.db.collection('stories').doc(storyId).update({
      publishDate: formattedDate,
      updatedAt: new Date()
    });
    
    alert('‚úÖ –î–∞—Ç–∞ –∞–Ω–æ–Ω—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!');
    this.loadStoriesSchedule();
    
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
    alert('‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∞—Ç—ã –∞–Ω–æ–Ω—Å–∞');
  }
}
      else if (viewName === 'settings') {
          this.loadThemeControls();
        }
      }

      showCreateStoryModal() {
        document.getElementById('createStoryModal').style.display = 'flex';
        document.getElementById('createStoryForm').reset();
        document.getElementById('coverPreview').style.display = 'none';
        document.getElementById('datePrecision').textContent = '';
      }

      hideModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
      }

      handleCoverSelect(file) {
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
          const preview = document.getElementById('coverPreview');
          const img = document.getElementById('coverPreviewImg');
          img.src = e.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      }

      updateDatePrecision(dateString) {
        const precisionEl = document.getElementById('datePrecision');
        if (!dateString.trim()) {
          precisionEl.textContent = '';
          return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
        if (dateString.match(/^\d{2}\.\d{2}\.\d{4}$/)) {
          precisionEl.textContent = '‚úÖ —Ç–æ—á–Ω–∞—è –¥–∞—Ç–∞';
        } else if (dateString.match(/^\d{2}\.\d{4}$/)) {
          precisionEl.textContent = 'üìÖ –º–µ—Å—è—Ü –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω';
        } else if (dateString.match(/^\d{4}$/)) {
          precisionEl.textContent = 'üìÖ –≥–æ–¥ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω';
        } else {
          precisionEl.textContent = '‚ùå –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì, –ú–ú.–ì–ì–ì–ì –∏–ª–∏ –ì–ì–ì–ì)';
        }
      }

      async createStory() {
        const title = document.getElementById('storyTitle').value.trim();
        const description = document.getElementById('storyDescription').value.trim();
        const plannedEpisodes = document.getElementById('plannedEpisodes').value;
        const publishDate = document.getElementById('publishDate').value.trim();

        if (!title) {
          alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏');
          return;
        }

        // –°–æ–±–∏—Ä–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∂–∞–Ω—Ä—ã
        const genres = [];
        document.querySelectorAll('input[type="checkbox"]:checked').forEach(checkbox => {
          genres.push(checkbox.value);
        });

        try {
          const storyData = {
            title: title,
            description: description,
            coverUrl: document.getElementById('coverPreviewImg').src || '',
            plannedEpisodes: plannedEpisodes ? parseInt(plannedEpisodes) : null,
            publishDate: publishDate || null,
            genres: genres,
            status: 'announcement',
            episodesCount: 0,
            createdAt: new Date(),
            updatedAt: new Date()
          };

          if (this.db) {
            const docRef = await this.db.collection('stories').add(storyData);
            console.log('‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∞:', docRef.id);
          } else {
            // –î–µ–º–æ-—Ä–µ–∂–∏–º
            storyData.id = 'demo-' + Date.now();
            this.stories.push(storyData);
          }

          this.hideModal('createStoryModal');
          this.loadStories();
          alert('‚úÖ –ê–Ω–æ–Ω—Å –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω!');
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏:', error);
          alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏');
        }
      }

      async loadStories() {
        try {
          if (this.db) {
            const snapshot = await this.db.collection('stories').orderBy('createdAt', 'desc').get();
            this.stories = snapshot.docs.map(doc => ({
              id: doc.id,
              ...doc.data()
            }));
          }

          this.renderStories();
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–π:', error);
          // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
          this.stories = [
            {
              id: 'demo-1',
              title: '–ü—Ä–∏–º–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏',
              description: '–≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è',
              status: 'announcement',
              publishDate: '12.2024',
              episodesCount: 0,
              createdAt: new Date()
            }
          ];
          this.renderStories();
        }
      }

      renderStories() {
        const container = document.getElementById('storiesList');
        
        if (!container) return;
        
        if (this.stories.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="icon">üìö</div>
              <p>–ò—Å—Ç–æ—Ä–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
              <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∏—Å—Ç–æ—Ä–∏—é</p>
            </div>
          `;
          return;
        }

        container.innerHTML = this.stories.map(story => `
          <div class="story-card" onclick="adminPanel.openStoryConfig('${story.id}')">
            <div class="story-card-corner"></div>
            <div class="story-header">
              <h3 class="story-title">${story.title}</h3>
              <div class="story-meta">
                <span class="badge ${story.status}">${this.getStatusText(story.status)}</span>
                ${story.episodesCount > 0 ? `<span class="badge">üìä ${story.episodesCount} —ç–ø.</span>` : ''}
              </div>
            </div>
            <p class="story-desc">${story.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</p>
            ${story.publishDate ? `<div class="story-date">üìÖ ${this.formatPublishDate(story.publishDate)}</div>` : ''}
          </div>
        `).join('');
        
        // –ë–ï–ó–û–ü–ê–°–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ï–ö–û–†–ê–¶–ò–ô
        if (this.themeSystem && this.themeSystem.currentTheme) {
          this.themeSystem.updateDecorations(this.themeSystem.currentTheme);
        }
      }

      openStoryConfig(storyId) {
        window.open(`admin_config.html?story=${storyId}`, '_blank');
      }

      async loadSchedule() {
        const container = document.getElementById('scheduleList');
        
        const scheduledStories = this.stories.filter(story => story.publishDate);
        
        if (scheduledStories.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="icon">üìÖ</div>
              <p>–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π</p>
            </div>
          `;
          return;
        }

        container.innerHTML = scheduledStories.map(story => `
          <div class="schedule-item">
            <div class="schedule-info">
              <h4>${story.title}</h4>
              <p>${story.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
            </div>
            <div class="schedule-date">
              <div class="publish-date">${this.formatPublishDate(story.publishDate)}</div>
              <div class="publish-status">${this.getStatusText(story.status)}</div>
            </div>
          </div>
        `).join('');
      }

      loadThemeControls() {
        // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ window.themesSystem —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if (!window.themesSystem) {
          setTimeout(() => this.loadThemeControls(), 100);
          return;
        }

        const container = document.getElementById('themeControls');
        const autoModeCheckbox = document.getElementById('autoThemeMode');
        
        // –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω - –∂–¥–µ–º –∏ –ø—Ä–æ–±—É–µ–º —Å–Ω–æ–≤–∞
        if (!container) {
          setTimeout(() => this.loadThemeControls(), 100);
          return;
        }
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ç–µ–º –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        const themes = window.themesSystem.getAvailableThemes() || {};
        const currentTheme = window.themesSystem.getCurrentTheme();
        const isManualMode = window.themesSystem.isManualMode();
        
        container.innerHTML = Object.entries(themes).map(([themeKey, theme]) => {
          const isActive = isManualMode && currentTheme === themeKey;
          const isManual = isManualMode && currentTheme === themeKey;
          const showSettings = isActive;
          
          return `
            <div class="theme-control ${isActive ? 'active' : ''}" style="background: var(--bg-secondary); padding: 15px; border-radius: 8px; margin-bottom: 12px; border: 1px solid var(--border-light);">
              <div class="theme-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div>
                  <div class="theme-name" style="font-weight: bold; font-size: 16px;">${theme.name}</div>
                  <div class="theme-dates" style="font-size: 12px; color: var(--text-secondary);">–ü–µ—Ä–∏–æ–¥: ${theme.startMonth}-${theme.startDay} –ø–æ ${theme.endMonth}-${theme.endDay}</div>
                </div>
                <div>
                  ${isManual ? '<span style="color: var(--accent-primary); font-size: 12px; background: rgba(255,232,31,0.1); padding: 4px 8px; border-radius: 4px;">üëÜ –ê–∫—Ç–∏–≤–Ω–∞</span>' : ''}
                </div>
              </div>
              
              <div class="theme-controls-row" style="display: flex; gap: 8px; flex-wrap: wrap;">
                <button class="btn btn-small ${isManual ? 'btn-success' : 'btn-secondary'}" 
                        onclick="window.themesSystem?.setManualTheme('${themeKey}'); document.getElementById('settingsView').innerHTML=''; setTimeout(() => window.adminPanel.loadThemeControls(), 100);"
                        style="flex: 1; min-width: 100px;">
                  ${isManual ? '‚úÖ –í–∫–ª' : 'üëÅÔ∏è –í–∫–ª—é—á–∏—Ç—å'}
                </button>
                
                <button class="btn btn-small btn-secondary" 
                        onclick="window.themesSystem?.disableManualMode(); setTimeout(() => window.adminPanel.loadThemeControls(), 100);"
                        style="flex: 1; min-width: 100px;">
                  üîÑ –ê–≤—Ç–æ-—Ä–µ–∂–∏–º
                </button>
              </div>
            </div>
          `;
        }).join('');
      }

      toggleTheme(themeId) {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        if (window.themesSystem?.getCurrentTheme() === themeId) {
          window.themesSystem.disableManualMode();
        } else {
          window.themesSystem?.setManualTheme(themeId);
        }
        this.loadThemeControls();
      }

      toggleThemeSettings(themeId) {
        const settings = document.getElementById(`settings-${themeId}`);
        if (settings) settings.classList.toggle('active');
      }

      previewTheme(themeId) {
        window.themesSystem?.setManualTheme(themeId);
        setTimeout(() => {
          window.themesSystem?.disableManualMode();
        }, 3000);
      }

      disableManualTheme() {
        window.themesSystem?.disableManualMode();
        this.loadThemeControls();
      }

      setThemeIntensity(themeId, intensity) {
        console.log(`–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å ${intensity} –¥–ª—è —Ç–µ–º—ã ${themeId}`);
        // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
      }

      createCustomTheme() {
        alert('–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ç–µ–º—ã –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
      }

      resetThemes() {
        if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º? –ë—É–¥—É—Ç –≤–∫–ª—é—á–µ–Ω—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.')) {
          this.themeSystem.disableManualTheme();
          this.themeSystem.setAutoMode(true);
          localStorage.removeItem('themeSettings');
          this.loadThemeControls();
          alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º —Å–±—Ä–æ—à–µ–Ω—ã');
        }
      }

      getStatusText(status) {
        const statuses = {
          'announcement': '–ê–Ω–æ–Ω—Å',
          'draft': '–ß–µ—Ä–Ω–æ–≤–∏–∫',
          'releasing': '–í—ã—Ö–æ–¥–∏—Ç',
          'published': '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ',
          'hidden': '–°–∫—Ä—ã—Ç–æ'
        };
        return statuses[status] || status;
      }

      formatPublishDate(dateString) {
        if (dateString.match(/^\d{2}\.\d{2}\.\d{4}$/)) {
          return `–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ: ${dateString}`;
        } else if (dateString.match(/^\d{2}\.\d{4}$/)) {
          const [month, year] = dateString.split('.');
          const monthNames = ['—è–Ω–≤–∞—Ä—å', '—Ñ–µ–≤—Ä–∞–ª—å', '–º–∞—Ä—Ç', '–∞–ø—Ä–µ–ª—å', '–º–∞–π', '–∏—é–Ω—å', '–∏—é–ª—å', '–∞–≤–≥—É—Å—Ç', '—Å–µ–Ω—Ç—è–±—Ä—å', '–æ–∫—Ç—è–±—Ä—å', '–Ω–æ—è–±—Ä—å', '–¥–µ–∫–∞–±—Ä—å'];
          return `–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ ${monthNames[parseInt(month) - 1]} ${year}`;
        } else if (dateString.match(/^\d{4}$/)) {
          return `–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ ${dateString}`;
        }
        return dateString;
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
    document.addEventListener('DOMContentLoaded', () => {
      window.adminPanel = new AdminPanel();
      window.themeSystem = window.adminPanel.themeSystem;
    });
  </script>
  <script src="themes-system.js"></script>
</body>
</html>
